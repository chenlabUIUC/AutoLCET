# AutoLCET
Fast tomography control on FEI electron microscopy with a GUI. This is the tomography acquisition algorithm used in paper: Autonomous 4D Videotomography of Nanoparticle Reactions.  
1. Requirements: temscript (https://github.com/niermann/temscript), opencv-python, matplotlib, numpy, mss. The temscript package provides a Python wrapper for the scripting interface of Thermo Fisher Scientific and FEI microscopes. Please refer to https://temscript.readthedocs.io/en/latest/about.html for its installation.  
2. The first button enables the microscopy control. Then you must successfully connect to a microscope to use the controlling functions. Without microscopy control enabled you may freely explore the functions, which will not actually interact with anything.
3. Set the camera to continuous recording mode in TIA (or Velox) and let the app look at the display port by adjusting X, Y, and W. The app can schedule the tilt series acquisition but does not capture any projection images or movie. The app also automatically tracks the nanoparticle position and center the particle during the acquisition by performing real-time thresholding. Adjust Blur, Thresh, Margin, AreaLB, and AreaUB to refine the thresholding result. Beside the straightforward Blur(Gaussian blur sigma) and Thresh (intensity threshold), Margin ignores any feature near the image border; AreaLB and AreaUB filter any too small or too large objects.
4. For other parameters, Microscopy IP and Port are used to connecte to the microscope, which is usually or by default 192.168.0.1 and 8080. The FOV is the field of view at the current magnification, which has to be manually input to calculate the pixel-to-nanometer scale to move the stage. The Multiplier is multiplied to the pixel-to-nanometer scale to consider for inaccurate scale calibration. The app sends commands to move the stage while continuously grabbing and displaying the viewing port of TIA (or Velox). A Delay time is used to make sure the previous stage motion (tilt or translate) command is returned before sending the next command. Usually 2 seconds are sufficient. The Trans threshold skips the centering if the center of the particle is already within its value to the image center.  
5. After the acquisition the app saves a csv file containing the time stamps and corresponding tilt angles during the acquisition, which is later used to extract the projection images (tilt series) from the movie saved by TIA. Please refer to the folder "tilt series extraction example" for this step.  
6. Author: lance.yao@pnnl.gov  
